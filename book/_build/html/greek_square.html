

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>17. Computing Square Roots &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/code.css" />
    <link rel="stylesheet" type="text/css" href="_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/fix_admonition_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/fix_dropdown_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/fix_code_header_style.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KZLV7PM9LL"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KZLV7PM9LL');
            </script>
    <script defer="defer" src="_static/refresh.js"></script>
    <script>const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script defer="defer" src="_static/sphinx-thebe-lite.js"></script>
    <script>window.MathJax = {"chtml": {"mtextInheritFont": true}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'greek_square';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://quantecon.org/greek_square.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="18. Distributions and Probabilities" href="prob_dist.html" />
    <link rel="prev" title="16. Eigenvalues and Eigenvectors" href="eigen_I.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="February 1, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/qe-logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/qe-logo.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">QuantEcon Intro Lectures</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about.html">1. About These Lectures</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Economic Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="long_run_growth.html">2. Long-Run Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="business_cycle.html">3. Business Cycles</a></li>
<li class="toctree-l1"><a class="reference internal" href="inflation_history.html">4. Price Level Histories</a></li>
<li class="toctree-l1"><a class="reference internal" href="french_rev.html">5. Inflation During French Revolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="inequality.html">6. Income and Wealth Inequality</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Foundations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro_supply_demand.html">7. Introduction to Supply and Demand</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_equations.html">8. Linear Equations and Matrix Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex_and_trig.html">9. Complex Numbers and Trigonometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="geom_series.html">10. Geometric Series for Elementary Economics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Dynamics: Finite Horizons</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pv.html">11. Present Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="cons_smooth.html">12. Consumption Smoothing</a></li>
<li class="toctree-l1"><a class="reference internal" href="equalizing_difference.html">13. Equalizing Difference Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="cagan_ree.html">14. A Monetarist Theory of Price Levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="cagan_adaptive.html">15. Monetarist Theory of Price Levels with Adaptive Expectations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Dynamics: Infinite Horizons</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="eigen_I.html">16. Eigenvalues and Eigenvectors</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">17. Computing Square Roots</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Probability and Distributions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="prob_dist.html">18. Distributions and Probabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="lln_clt.html">19. LLN and CLT</a></li>
<li class="toctree-l1"><a class="reference internal" href="monte_carlo.html">20. Monte Carlo and Option Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="heavy_tails.html">21. Heavy-Tailed Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="schelling.html">22. Racial Segregation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Nonlinear Dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scalar_dynam.html">23. Dynamics in One Dimension</a></li>
<li class="toctree-l1"><a class="reference internal" href="solow.html">24. The Solow-Swan Growth Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="cobweb.html">25. The Cobweb Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="olg.html">26. The Overlapping Generations Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="commod_price.html">27. Commodity Prices</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Monetary-Fiscal Policy Interactions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="money_inflation.html">28. Money Financed Government Deficits and Price Levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="unpleasant.html">29. Some Unpleasant Monetarist Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="money_inflation_nonlinear.html">30. Inflation Rate Laffer Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="laffer_adaptive.html">31. Laffer Curves  with Adaptive Expectations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Stochastic Dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ar1_processes.html">32. AR(1) Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="markov_chains_I.html">33. Markov Chains: Basic Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="markov_chains_II.html">34. Markov Chains: Irreducibility and Ergodicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_series_with_matrices.html">35. Univariate Time Series with Matrix Algebra</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Optimization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lp_intro.html">36. Linear Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="short_path.html">37. Shortest Paths</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modeling in Higher Dimensions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="eigen_II.html">38. The Perron-Frobenius Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_output.html">39. Input-Output Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="lake_model.html">40. A Lake Model of Employment</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">41. Networks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Markets and Competitive Equilibrium</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="supply_demand_multiple_goods.html">42. Supply and Demand with Many Goods</a></li>
<li class="toctree-l1"><a class="reference internal" href="supply_demand_heterogeneity.html">43. Market Equilibrium with Heterogeneity</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Estimation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="simple_linear_regression.html">44. Simple Linear Regression Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="mle.html">45. Maximum Likelihood Estimation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">46. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">47. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">48. Execution Statistics</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/greek_square.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="_sources/greek_square.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Computing Square Roots</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">17.1. Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perfect-squares-and-irrational-numbers">17.2. Perfect squares and irrational numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order-linear-difference-equations">17.3. Second-order linear difference equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm-of-the-ancient-greeks">17.4. Algorithm of the Ancient Greeks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">17.5. Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorizing-the-difference-equation">17.6. Vectorizing the difference equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invariant-subspace-approach">17.7. Invariant subspace approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concluding-remarks">17.8. Concluding remarks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">17.9. Exercise</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="computing-square-roots">
<h1><span class="section-number">17. </span>Computing Square Roots<a class="headerlink" href="#computing-square-roots" title="Permalink to this heading">#</a></h1>
<section id="introduction">
<h2><span class="section-number">17.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Chapter 24 of <span id="id1">[]</span> about early Greek mathematics and astronomy contains this
fascinating passage:</p>
<blockquote class="epigraph">
<div><p>The square root of 2, which was the first irrational to be discovered, was known to the early Pythagoreans, and ingenious methods of approximating to its value were discovered. The best was as follows: Form two columns of numbers, which we will call the <span class="math notranslate nohighlight">\(a\)</span>’s and the <span class="math notranslate nohighlight">\(b\)</span>’s; each starts with a <span class="math notranslate nohighlight">\(1\)</span>. The next <span class="math notranslate nohighlight">\(a\)</span>, at each stage, is formed by adding the last <span class="math notranslate nohighlight">\(a\)</span> and the <span class="math notranslate nohighlight">\(b\)</span> already obtained; the next <span class="math notranslate nohighlight">\(b\)</span> is formed by adding twice the previous <span class="math notranslate nohighlight">\(a\)</span> to the previous <span class="math notranslate nohighlight">\(b\)</span>. The first 6 pairs so obtained are <span class="math notranslate nohighlight">\((1,1), (2,3), (5,7), (12,17), (29,41), (70,99)\)</span>. In each pair, <span class="math notranslate nohighlight">\(2 a - b\)</span> is <span class="math notranslate nohighlight">\(1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span>. Thus <span class="math notranslate nohighlight">\(b/a\)</span> is nearly the square root of two, and at each fresh step it gets nearer. For instance, the reader may satisy himself that the square of <span class="math notranslate nohighlight">\(99/70\)</span> is very nearly equal to <span class="math notranslate nohighlight">\(2\)</span>.</p>
</div></blockquote>
<p>This lecture drills down and studies this ancient method for computing square roots by using some of the matrix algebra that we’ve learned in earlier quantecon lectures.</p>
<p>In particular, this lecture can be viewed as a sequel to <a class="reference internal" href="eigen_I.html"><span class="doc">Eigenvalues and Eigenvectors</span></a>.</p>
<p>It  provides an  example of how eigenvectors isolate  <em>invariant subspaces</em> that help construct and analyze solutions of linear difference equations.</p>
<p>When vector <span class="math notranslate nohighlight">\(x_t\)</span> starts in an invariant subspace, iterating the different equation keeps <span class="math notranslate nohighlight">\(x_{t+j}\)</span>
in that subspace for all <span class="math notranslate nohighlight">\(j \geq 1\)</span>.</p>
<p>Invariant subspace methods are used throughout applied economic dynamics, for example, in the lecture <a class="reference internal" href="money_inflation.html"><span class="doc">Money Financed Government Deficits and Price Levels</span></a>.</p>
<p>Our approach here  is to illustrate the method with an ancient example, one that ancient Greek mathematicians used to compute square roots of positive integers.</p>
</section>
<section id="perfect-squares-and-irrational-numbers">
<h2><span class="section-number">17.2. </span>Perfect squares and irrational numbers<a class="headerlink" href="#perfect-squares-and-irrational-numbers" title="Permalink to this heading">#</a></h2>
<p>An integer is called a <strong>perfect square</strong> if its square root is also an integer.</p>
<p>An ordered sequence of  perfect squares starts with</p>
<div class="math notranslate nohighlight">
\[
4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, \ldots 
\]</div>
<p>If an integer is not a perfect square, then its square root is an irrational number – i.e., it cannot be expressed as a ratio of two integers, and its decimal expansion is indefinite.</p>
<p>The ancient Greeks invented an algorithm to compute square roots of integers, including integers that are not perfect squares.</p>
<p>Their method involved</p>
<ul class="simple">
<li><p>computing a particular sequence of integers <span class="math notranslate nohighlight">\(\{y_t\}_{t=0}^\infty\)</span>;</p></li>
<li><p>computing <span class="math notranslate nohighlight">\(\lim_{t \rightarrow \infty} \left(\frac{y_{t+1}}{y_t}\right) = \bar r\)</span>;</p></li>
<li><p>deducing the desired square root from <span class="math notranslate nohighlight">\(\bar r\)</span>.</p></li>
</ul>
<p>In this lecture, we’ll describe this method.</p>
<p>We’ll also use invariant subspaces to describe variations on this method that are faster.</p>
</section>
<section id="second-order-linear-difference-equations">
<h2><span class="section-number">17.3. </span>Second-order linear difference equations<a class="headerlink" href="#second-order-linear-difference-equations" title="Permalink to this heading">#</a></h2>
<p>Before telling how the ancient Greeks computed square roots, we’ll provide a quick introduction
to second-order linear difference equations.</p>
<p>We’ll study  the following second-order linear difference equation</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff1">
<span class="eqno">(17.1)<a class="headerlink" href="#equation-eq-2diff1" title="Permalink to this equation">#</a></span>\[
y_t = a_1 y_{t-1} + a_2 y_{t-2}, \quad t \geq 0
\]</div>
<p>where <span class="math notranslate nohighlight">\((y_{-1},  y_{-2})\)</span> is a pair of given initial conditions.</p>
<p>Equation <a class="reference internal" href="#equation-eq-2diff1">(17.1)</a> is actually an infinite number of linear equations in the sequence
<span class="math notranslate nohighlight">\(\{y_t\}_{t=0}^\infty\)</span>.</p>
<p>There is one equation each for <span class="math notranslate nohighlight">\(t = 0, 1, 2, \ldots\)</span>.</p>
<p>We could follow an approach taken in the lecture on <a class="reference internal" href="pv.html"><span class="doc">present values</span></a> and stack all of these equations into a single matrix equation that we would then solve by using matrix inversion.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the present instance, the matrix equation would multiply a countably infinite dimensional square matrix by  a countably infinite dimensional vector.  With some qualifications, matrix multiplication and inversion tools apply to such an equation.</p>
</div>
<p>But we won’t pursue that approach here.</p>
<p>Instead, we’ll seek to find a time-invariant function that <em>solves</em> our difference equation, meaning
that it provides a formula for a <span class="math notranslate nohighlight">\(\{y_t\}_{t=0}^\infty\)</span> sequence that satisfies
equation <a class="reference internal" href="#equation-eq-2diff1">(17.1)</a> for each <span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<p>We seek an expression  for <span class="math notranslate nohighlight">\(y_t, t \geq 0\)</span> as functions of the initial conditions  <span class="math notranslate nohighlight">\((y_{-1},  y_{-2})\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff2">
<span class="eqno">(17.2)<a class="headerlink" href="#equation-eq-2diff2" title="Permalink to this equation">#</a></span>\[ 
y_t = g((y_{-1},  y_{-2});t), \quad t \geq 0.
\]</div>
<p>We call such a function <span class="math notranslate nohighlight">\(g\)</span> a <em>solution</em> of the difference equation <a class="reference internal" href="#equation-eq-2diff1">(17.1)</a>.</p>
<p>One way to discover a solution is to use a guess and verify method.</p>
<p>We shall begin by considering a special initial pair of initial  conditions
that satisfy</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff3">
<span class="eqno">(17.3)<a class="headerlink" href="#equation-eq-2diff3" title="Permalink to this equation">#</a></span>\[
y_{-1} = \delta y_{-2}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\)</span> is a scalar to be determined.</p>
<p>For initial condition that satisfy <a class="reference internal" href="#equation-eq-2diff3">(17.3)</a>
equation <a class="reference internal" href="#equation-eq-2diff1">(17.1)</a> impllies that</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff4">
<span class="eqno">(17.4)<a class="headerlink" href="#equation-eq-2diff4" title="Permalink to this equation">#</a></span>\[
y_0 = \left(a_1 + \frac{a_2}{\delta}\right) y_{-1}.
\]</div>
<p>We want</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff5">
<span class="eqno">(17.5)<a class="headerlink" href="#equation-eq-2diff5" title="Permalink to this equation">#</a></span>\[
\left(a_1 + \frac{a_2}{\delta}\right) = \delta
\]</div>
<p>which we can rewrite as the <em>characteristic equation</em></p>
<div class="math notranslate nohighlight" id="equation-eq-2diff6">
<span class="eqno">(17.6)<a class="headerlink" href="#equation-eq-2diff6" title="Permalink to this equation">#</a></span>\[
\delta^2 - a_1 \delta - a_2 = 0.
\]</div>
<p>Applying the quadratic formula to solve for the roots of <a class="reference internal" href="#equation-eq-2diff6">(17.6)</a> we find that</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff7">
<span class="eqno">(17.7)<a class="headerlink" href="#equation-eq-2diff7" title="Permalink to this equation">#</a></span>\[
\delta = \frac{ a_1 \pm \sqrt{a_1^2 + 4 a_2}}{2}.
\]</div>
<p>For either of the two <span class="math notranslate nohighlight">\(\delta\)</span>’s that satisfy equation <a class="reference internal" href="#equation-eq-2diff7">(17.7)</a>,
a solution of difference equation <a class="reference internal" href="#equation-eq-2diff1">(17.1)</a> is</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff8">
<span class="eqno">(17.8)<a class="headerlink" href="#equation-eq-2diff8" title="Permalink to this equation">#</a></span>\[
y_t = \delta^t y_0 , \forall t \geq 0
\]</div>
<p>provided that we set</p>
<div class="math notranslate nohighlight">
\[
y_0 = \delta  y_{-1} . 
\]</div>
<p>The <em>general</em> solution of difference equation <a class="reference internal" href="#equation-eq-2diff1">(17.1)</a> takes the form</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff9">
<span class="eqno">(17.9)<a class="headerlink" href="#equation-eq-2diff9" title="Permalink to this equation">#</a></span>\[
y_t = \eta_1 \delta_1^t + \eta_2 \delta_2^t
\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta_1, \delta_2\)</span> are the two solutions <a class="reference internal" href="#equation-eq-2diff7">(17.7)</a> of the characteristic equation <a class="reference internal" href="#equation-eq-2diff6">(17.6)</a>, and  <span class="math notranslate nohighlight">\(\eta_1, \eta_2\)</span> are two constants chosen to satisfy</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff10">
<span class="eqno">(17.10)<a class="headerlink" href="#equation-eq-2diff10" title="Permalink to this equation">#</a></span>\[ 
    \begin{bmatrix} y_{-1} \cr y_{-2} \end{bmatrix} = \begin{bmatrix} \delta_1^{-1}  &amp; \delta_2^{-1} \cr \delta_1^{-2} &amp; \delta_2^{-2} \end{bmatrix} \begin{bmatrix} \eta_1 \cr \eta_2 \end{bmatrix} 
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-eq-2diff11">
<span class="eqno">(17.11)<a class="headerlink" href="#equation-eq-2diff11" title="Permalink to this equation">#</a></span>\[
\begin{bmatrix} \eta_1 \cr \eta_2 \end{bmatrix} = \begin{bmatrix} \delta_1^{-1}  &amp; \delta_2^{-1} \cr \delta_1^{-2} &amp; \delta_2^{-2} \end{bmatrix}^{-1} \begin{bmatrix} y_{-1} \cr y_{-2} \end{bmatrix}
\]</div>
<p>Sometimes we are free to choose the initial conditions <span class="math notranslate nohighlight">\((y_{-1}, y_{-2})\)</span>, in which case we
use system <a class="reference internal" href="#equation-eq-2diff10">(17.10)</a> to find the associated <span class="math notranslate nohighlight">\((\eta_1, \eta_2)\)</span>.</p>
<p>If we choose <span class="math notranslate nohighlight">\((y_{-1}, y_{-2})\)</span> to set <span class="math notranslate nohighlight">\((\eta_1, \eta_2) = (1, 0)\)</span>, then <span class="math notranslate nohighlight">\(y_t = \delta_1^t\)</span> for all <span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<p>If we choose <span class="math notranslate nohighlight">\((y_{-1}, y_{-2})\)</span> to set <span class="math notranslate nohighlight">\((\eta_1, \eta_2) = (0, 1)\)</span>, then <span class="math notranslate nohighlight">\(y_t = \delta_2^t\)</span> for all <span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<p>Soon we’ll relate the preceding calculations to components an eigen decomposition of a transition matrix that represents difference equation <a class="reference internal" href="#equation-eq-2diff1">(17.1)</a> in a very convenient way.</p>
<p>We’ll turn to that after we describe how Ancient Greeks figured out how to compute square roots of positive integers that are not perfect squares.</p>
</section>
<section id="algorithm-of-the-ancient-greeks">
<h2><span class="section-number">17.4. </span>Algorithm of the Ancient Greeks<a class="headerlink" href="#algorithm-of-the-ancient-greeks" title="Permalink to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(\sigma\)</span> be a positive  integer greater than <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>So <span class="math notranslate nohighlight">\(\sigma \in {\mathcal I} \equiv  \{2, 3, \ldots \}\)</span>.</p>
<p>We want an algorithm to compute the square root of <span class="math notranslate nohighlight">\(\sigma \in {\mathcal I}\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\sqrt{\sigma} \in {\mathcal I}\)</span>, <span class="math notranslate nohighlight">\(\sigma \)</span> is said to be a <em>perfect square</em>.</p>
<p>If <span class="math notranslate nohighlight">\(\sqrt{\sigma} \not\in {\mathcal I}\)</span>, it turns out that it is irrational.</p>
<p>Ancient Greeks used a recursive algorithm to compute square roots of integers that are not perfect squares.</p>
<p>The algorithm iterates on a  second-order  linear  difference equation in the sequence <span class="math notranslate nohighlight">\(\{y_t\}_{t=0}^\infty\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-second-order">
<span class="eqno">(17.12)<a class="headerlink" href="#equation-eq-second-order" title="Permalink to this equation">#</a></span>\[
y_{t} = 2 y_{t-1} - (1 - \sigma) y_{t-2}, \quad t \geq 0
\]</div>
<p>together with a pair of integers that are initial conditions for <span class="math notranslate nohighlight">\(y_{-1}, y_{-2}\)</span>.</p>
<p>First, we’ll deploy some techniques for solving the difference equations that are also deployed in <span class="xref std std-doc">dynam:samuelson</span>.</p>
<p>The characteristic equation associated with difference equation <a class="reference internal" href="#equation-eq-second-order">(17.12)</a> is</p>
<div class="math notranslate nohighlight" id="equation-eq-cha-eq0">
<span class="eqno">(17.13)<a class="headerlink" href="#equation-eq-cha-eq0" title="Permalink to this equation">#</a></span>\[
c(x) \equiv x^2 - 2 x + (1 - \sigma) = 0
\]</div>
<p>(Notice how this is an instance of equation <a class="reference internal" href="#equation-eq-2diff6">(17.6)</a> above.)</p>
<p>Factoring the right side of   equation <a class="reference internal" href="#equation-eq-cha-eq0">(17.13)</a>, we obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-cha-eq">
<span class="eqno">(17.14)<a class="headerlink" href="#equation-eq-cha-eq" title="Permalink to this equation">#</a></span>\[
c(x)= (x - \lambda_1) (x-\lambda_2) = 0
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ 
c(x) = 0 
\]</div>
<p>for <span class="math notranslate nohighlight">\(x = \lambda_1\)</span> or <span class="math notranslate nohighlight">\(x = \lambda_2\)</span>.</p>
<p>These two special values of <span class="math notranslate nohighlight">\(x\)</span> are sometimes called zeros or roots of <span class="math notranslate nohighlight">\(c(x)\)</span>.</p>
<p>By applying the quadratic formula to solve for the roots  the characteristic equation
<a class="reference internal" href="#equation-eq-cha-eq0">(17.13)</a>, we find that</p>
<div class="math notranslate nohighlight" id="equation-eq-secretweapon">
<span class="eqno">(17.15)<a class="headerlink" href="#equation-eq-secretweapon" title="Permalink to this equation">#</a></span>\[
\lambda_1 = 1 + \sqrt{\sigma}, \quad \lambda_2 = 1 - \sqrt{\sigma}.
\]</div>
<p>Formulas <a class="reference internal" href="#equation-eq-secretweapon">(17.15)</a> indicate that  <span class="math notranslate nohighlight">\(\lambda_1\)</span> and  <span class="math notranslate nohighlight">\(\lambda_2\)</span> are each functions
of a single variable, namely,  <span class="math notranslate nohighlight">\(\sqrt{\sigma}\)</span>, the object that we along with some Ancient Greeks want to compute.</p>
<p>Ancient Greeks had an indirect way of exploiting this fact to compute square roots of a positive integer.</p>
<p>They did this by starting from particular initial conditions <span class="math notranslate nohighlight">\(y_{-1}, y_{-2}\)</span> and iterating on the difference equation <a class="reference internal" href="#equation-eq-second-order">(17.12)</a>.</p>
<p>Solutions  of  difference equation <a class="reference internal" href="#equation-eq-second-order">(17.12)</a> take the form</p>
<div class="math notranslate nohighlight">
\[
y_t = \lambda_1^t \eta_1 + \lambda_2^t \eta_2
\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta_1\)</span> and <span class="math notranslate nohighlight">\(\eta_2\)</span> are chosen to satisfy   prescribed initial conditions <span class="math notranslate nohighlight">\(y_{-1}, y_{-2}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-leq-sq">
<span class="eqno">(17.16)<a class="headerlink" href="#equation-eq-leq-sq" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
\lambda_1^{-1} \eta_1 + \lambda_2^{-1} \eta_2 &amp; =  y_{-1} \cr
\lambda_1^{-2} \eta_1 + \lambda_2^{-2} \eta_2 &amp; =  y_{-2}
\end{aligned}
\]</div>
<p>System <a class="reference internal" href="#equation-eq-leq-sq">(17.16)</a> of simultaneous linear equations will play a big role in the remainder of this lecture.</p>
<p>Since <span class="math notranslate nohighlight">\(\lambda_1 = 1 + \sqrt{\sigma} &gt; 1 &gt; \lambda_2 = 1 - \sqrt{\sigma} \)</span>,
it follows that for <em>almost all</em> (but not all) initial conditions</p>
<div class="math notranslate nohighlight">
\[
\lim_{t \rightarrow \infty} \left(\frac{y_{t+1}}{y_t}\right) = 1 + \sqrt{\sigma}.
\]</div>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[
\sqrt{\sigma} = \lim_{t \rightarrow \infty} \left(\frac{y_{t+1}}{y_t}\right) - 1.
\]</div>
<p>However, notice that if <span class="math notranslate nohighlight">\(\eta_1 = 0\)</span>, then</p>
<div class="math notranslate nohighlight">
\[
\lim_{t \rightarrow \infty} \left(\frac{y_{t+1}}{y_t}\right) = 1 - \sqrt{\sigma}
\]</div>
<p>so that</p>
<div class="math notranslate nohighlight">
\[
\sqrt{\sigma} = 1 - \lim_{t \rightarrow \infty} \left(\frac{y_{t+1}}{y_t}\right).
\]</div>
<p>Actually, if <span class="math notranslate nohighlight">\(\eta_1 =0\)</span>, it follows that</p>
<div class="math notranslate nohighlight">
\[
\sqrt{\sigma} = 1 - \left(\frac{y_{t+1}}{y_t}\right) \quad \forall t \geq 0,
\]</div>
<p>so that convergence is immediate and there is no need to take limits.</p>
<p>Symmetrically, if <span class="math notranslate nohighlight">\(\eta_2 =0\)</span>, it follows that</p>
<div class="math notranslate nohighlight">
\[
\sqrt{\sigma} =  \left(\frac{y_{t+1}}{y_t}\right) - 1 \quad \forall t \geq 0
\]</div>
<p>so again, convergence is immediate, and we have no need to compute a limit.</p>
<p>System <a class="reference internal" href="#equation-eq-leq-sq">(17.16)</a> of simultaneous linear equations can be used in various ways.</p>
<ul class="simple">
<li><p>we can take <span class="math notranslate nohighlight">\(y_{-1}, y_{-2}\)</span> as given initial conditions and solve for <span class="math notranslate nohighlight">\(\eta_1, \eta_2\)</span>;</p></li>
<li><p>we can instead take <span class="math notranslate nohighlight">\(\eta_1, \eta_2\)</span> as given and solve for initial conditions  <span class="math notranslate nohighlight">\(y_{-1}, y_{-2}\)</span>.</p></li>
</ul>
<p>Notice how we used the  second approach above when we set  <span class="math notranslate nohighlight">\(\eta_1, \eta_2\)</span>  either to <span class="math notranslate nohighlight">\((0, 1)\)</span>, for example, or <span class="math notranslate nohighlight">\((1, 0)\)</span>, for example.</p>
<p>In taking this second approach, we constructed an <em>invariant subspace</em> of <span class="math notranslate nohighlight">\({\bf R}^2\)</span>.</p>
<p>Here is what is going on.</p>
<p>For <span class="math notranslate nohighlight">\( t \geq 0\)</span> and for most pairs of  initial conditions <span class="math notranslate nohighlight">\((y_{-1}, y_{-2}) \in {\bf R}^2\)</span> for equation <a class="reference internal" href="#equation-eq-second-order">(17.12)</a>, <span class="math notranslate nohighlight">\(y_t\)</span> can be expressed as a linear combination  of <span class="math notranslate nohighlight">\(y_{t-1}\)</span> and <span class="math notranslate nohighlight">\(y_{t-2}\)</span>.</p>
<p>But for some special initial conditions <span class="math notranslate nohighlight">\((y_{-1}, y_{-2}) \in {\bf R}^2\)</span>, <span class="math notranslate nohighlight">\(y_t\)</span> can be expressed as a linear function  of <span class="math notranslate nohighlight">\(y_{t-1}\)</span> only.</p>
<p>These special initial conditions require that <span class="math notranslate nohighlight">\(y_{-1}\)</span> be a linear function of <span class="math notranslate nohighlight">\(y_{-2}\)</span>.</p>
<p>We’ll study these special initial conditions soon.</p>
<p>But first let’s write some Python code to iterate on equation <a class="reference internal" href="#equation-eq-second-order">(17.12)</a> starting from an arbitrary <span class="math notranslate nohighlight">\((y_{-1}, y_{-2}) \in {\bf R}^2\)</span>.</p>
</section>
<section id="implementation">
<h2><span class="section-number">17.5. </span>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">#</a></h2>
<p>We now implement the above algorithm to compute the square root of <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<p>In this lecture, we use the following import:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">solve_λs</span><span class="p">(</span><span class="n">coefs</span><span class="p">):</span>    
    <span class="c1"># Calculate the roots using numpy.roots</span>
    <span class="n">λs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span>
    
    <span class="c1"># Sort the roots for consistency</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">λs</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve_η</span><span class="p">(</span><span class="n">λ_1</span><span class="p">,</span> <span class="n">λ_2</span><span class="p">,</span> <span class="n">y_neg1</span><span class="p">,</span> <span class="n">y_neg2</span><span class="p">):</span>
    <span class="c1"># Solve the system of linear equation</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">λ_1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">λ_2</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">λ_1</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">λ_2</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
    <span class="p">])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">y_neg1</span><span class="p">,</span> <span class="n">y_neg2</span><span class="p">))</span>
    <span class="n">ηs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ηs</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve_sqrt</span><span class="p">(</span><span class="n">σ</span><span class="p">,</span> <span class="n">coefs</span><span class="p">,</span> <span class="n">y_neg1</span><span class="p">,</span> <span class="n">y_neg2</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="c1"># Ensure σ is greater than 1</span>
    <span class="k">if</span> <span class="n">σ</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;σ must be greater than 1&quot;</span><span class="p">)</span>
        
    <span class="c1"># Characteristic roots</span>
    <span class="n">λ_1</span><span class="p">,</span> <span class="n">λ_2</span> <span class="o">=</span> <span class="n">solve_λs</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span>
    
    <span class="c1"># Solve for η_1 and η_2</span>
    <span class="n">η_1</span><span class="p">,</span> <span class="n">η_2</span> <span class="o">=</span> <span class="n">solve_η</span><span class="p">(</span><span class="n">λ_1</span><span class="p">,</span> <span class="n">λ_2</span><span class="p">,</span> <span class="n">y_neg1</span><span class="p">,</span> <span class="n">y_neg2</span><span class="p">)</span>

    <span class="c1"># Compute the sequence up to t_max</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">λ_1</span> <span class="o">**</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">η_1</span> <span class="o">+</span> <span class="p">(</span><span class="n">λ_2</span> <span class="o">**</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">η_2</span>
    
    <span class="c1"># Compute the ratio y_{t+1} / y_t for large t</span>
    <span class="n">sqrt_σ_estimate</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
    
    <span class="k">return</span> <span class="n">sqrt_σ_estimate</span>

<span class="c1"># Use σ = 2 as an example</span>
<span class="n">σ</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Encode characteristic equation</span>
<span class="n">coefs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">σ</span><span class="p">))</span>

<span class="c1"># Solve for the square root of σ</span>
<span class="n">sqrt_σ</span> <span class="o">=</span> <span class="n">solve_sqrt</span><span class="p">(</span><span class="n">σ</span><span class="p">,</span> <span class="n">coefs</span><span class="p">,</span> <span class="n">y_neg1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_neg2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate the deviation</span>
<span class="n">dev</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sqrt_σ</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">σ</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sqrt(</span><span class="si">{</span><span class="n">σ</span><span class="si">}</span><span class="s2">) is approximately </span><span class="si">{</span><span class="n">sqrt_σ</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> (error: </span><span class="si">{</span><span class="n">dev</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we consider cases where <span class="math notranslate nohighlight">\((\eta_1, \eta_2) = (0, 1)\)</span> and <span class="math notranslate nohighlight">\((\eta_1, \eta_2) = (1, 0)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute λ_1, λ_2</span>
<span class="n">λ_1</span><span class="p">,</span> <span class="n">λ_2</span> <span class="o">=</span> <span class="n">solve_λs</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Roots for the characteristic equation are (</span><span class="si">{</span><span class="n">λ_1</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">λ_2</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">))&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Case 1: η_1, η_2 = (0, 1)</span>
<span class="n">ηs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Compute y_{t} and y_{t-1} with t &gt;= 0</span>
<span class="n">y</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">ηs</span><span class="p">:</span> <span class="p">(</span><span class="n">λ_1</span> <span class="o">**</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">ηs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">λ_2</span> <span class="o">**</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">ηs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sqrt_σ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ηs</span><span class="p">)</span> <span class="o">/</span> <span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ηs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For η_1, η_2 = (0, 1), sqrt_σ = </span><span class="si">{</span><span class="n">sqrt_σ</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Case 2: η_1, η_2 = (1, 0)</span>
<span class="n">ηs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">sqrt_σ</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ηs</span><span class="p">)</span> <span class="o">/</span> <span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ηs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For η_1, η_2 = (1, 0), sqrt_σ = </span><span class="si">{</span><span class="n">sqrt_σ</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We find that convergence is immediate.</p>
<p>Next, we’ll  represent the preceding analysis by first vectorizing our second-order difference equation <a class="reference internal" href="#equation-eq-second-order">(17.12)</a> and then using  eigendecompositions of an  associated  state transition matrix.</p>
</section>
<section id="vectorizing-the-difference-equation">
<h2><span class="section-number">17.6. </span>Vectorizing the difference equation<a class="headerlink" href="#vectorizing-the-difference-equation" title="Permalink to this heading">#</a></h2>
<p>Represent <a class="reference internal" href="#equation-eq-second-order">(17.12)</a> with the first-order matrix difference equation</p>
<div class="math notranslate nohighlight">
\[
\begin{bmatrix} y_{t+1} \cr y_{t} \end{bmatrix}
= \begin{bmatrix} 2 &amp; - ( 1 - \sigma) \cr 1 &amp; 0 \end{bmatrix} \begin{bmatrix} y_{t} \cr y_{t-1} \end{bmatrix}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
x_{t+1} = M x_t 
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
M = \begin{bmatrix} 2 &amp; - (1 - \sigma )  \cr 1 &amp; 0 \end{bmatrix},  \quad x_t= \begin{bmatrix} y_{t} \cr y_{t-1} \end{bmatrix}
\]</div>
<p>Construct an eigendecomposition of <span class="math notranslate nohighlight">\(M\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-eigen-sqrt">
<span class="eqno">(17.17)<a class="headerlink" href="#equation-eq-eigen-sqrt" title="Permalink to this equation">#</a></span>\[
M = V \begin{bmatrix} \lambda_1 &amp; 0 \cr 0 &amp; \lambda_2  \end{bmatrix} V^{-1} 
\]</div>
<p>where columns of <span class="math notranslate nohighlight">\(V\)</span> are eigenvectors corresponding to  eigenvalues <span class="math notranslate nohighlight">\(\lambda_1\)</span> and <span class="math notranslate nohighlight">\(\lambda_2\)</span>.</p>
<p>The eigenvalues can be ordered so that  <span class="math notranslate nohighlight">\(\lambda_1 &gt; 1 &gt; \lambda_2\)</span>.</p>
<p>Write equation <a class="reference internal" href="#equation-eq-second-order">(17.12)</a> as</p>
<div class="math notranslate nohighlight">
\[
x_{t+1} = V \Lambda V^{-1} x_t
\]</div>
<p>Now we implement the algorithm above.</p>
<p>First we write a function that iterates <span class="math notranslate nohighlight">\(M\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">iterate_M</span><span class="p">(</span><span class="n">x_0</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
    
    <span class="c1"># Eigendecomposition of M</span>
    <span class="n">Λ</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">V_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    
    <span class="c1"># Initialize the array to store results</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x_0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                   <span class="n">num_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    
    <span class="c1"># Perform the iterations</span>
    <span class="n">xs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">xs</span><span class="p">[:,</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span> <span class="o">@</span> <span class="n">xs</span><span class="p">[:,</span> <span class="n">t</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">xs</span><span class="p">,</span> <span class="n">Λ</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">V_inv</span>

<span class="c1"># Define the state transition matrix M</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
      <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">σ</span><span class="p">)],</span>
      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

<span class="c1"># Initial condition vector x_0</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># Perform the iteration</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">Λ</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">V_inv</span> <span class="o">=</span> <span class="n">iterate_M</span><span class="p">(</span><span class="n">x_0</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">num_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;eigenvalues:</span><span class="se">\n</span><span class="si">{</span><span class="n">Λ</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;eigenvectors:</span><span class="se">\n</span><span class="si">{</span><span class="n">V</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inverse eigenvectors:</span><span class="se">\n</span><span class="si">{</span><span class="n">V_inv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s compare the eigenvalues to the roots <a class="reference internal" href="#equation-eq-secretweapon">(17.15)</a> of equation
<a class="reference internal" href="#equation-eq-cha-eq0">(17.13)</a> that  we computed above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">roots</span> <span class="o">=</span> <span class="n">solve_λs</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">σ</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;roots: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">roots</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hence we confirmed <a class="reference internal" href="#equation-eq-eigen-sqrt">(17.17)</a>.</p>
<p>Information about the square root we are after is also contained
in the two  eigenvectors.</p>
<p>Indeed, each  eigenvector is just a two-dimensional subspace of <span class="math notranslate nohighlight">\({\mathbb R}^3\)</span> pinned down by dynamics of the form</p>
<div class="math notranslate nohighlight" id="equation-eq-invariantsub101">
<span class="eqno">(17.18)<a class="headerlink" href="#equation-eq-invariantsub101" title="Permalink to this equation">#</a></span>\[
y_{t} = \lambda_i y_{t-1}, \quad i = 1, 2 
\]</div>
<p>that we encountered above in equation <a class="reference internal" href="#equation-eq-2diff8">(17.8)</a> above.</p>
<p>In equation <a class="reference internal" href="#equation-eq-invariantsub101">(17.18)</a>, the <span class="math notranslate nohighlight">\(i\)</span>th <span class="math notranslate nohighlight">\(\lambda_i\)</span>  equals the <span class="math notranslate nohighlight">\(V_{i, 1}/V_{i,2}\)</span>.</p>
<p>The following graph verifies this for our example.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting the eigenvectors</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> 
           <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">fr</span><span class="s1">&#39;$\lambda_1=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Λ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> 
           <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">fr</span><span class="s1">&#39;$\lambda_2=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Λ</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="c1"># Annotating the slopes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> 
         <span class="sa">r</span><span class="s1">&#39;slope=$\frac{V_{1,1}}{V_{1,2}}=$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> 
         <span class="sa">r</span><span class="s1">&#39;slope=$\frac{V_{2,1}}{V_{2,2}}=$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>

<span class="c1"># Adding labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="invariant-subspace-approach">
<h2><span class="section-number">17.7. </span>Invariant subspace approach<a class="headerlink" href="#invariant-subspace-approach" title="Permalink to this heading">#</a></h2>
<p>The preceding  calculation indicates that we can use the eigenvectors <span class="math notranslate nohighlight">\(V\)</span> to construct 2-dimensional  <em>invariant subspaces</em>.</p>
<p>We’ll pursue that possibility now.</p>
<p>Define the transformed variables</p>
<div class="math notranslate nohighlight">
\[
x_t^* = V^{-1} x_t
\]</div>
<p>Evidently, we can recover <span class="math notranslate nohighlight">\(x_t\)</span> from <span class="math notranslate nohighlight">\(x_t^*\)</span>:</p>
<div class="math notranslate nohighlight">
\[
x_t = V x_t^*
\]</div>
<p>The following notations and equations will help us.</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[V = \begin{bmatrix} V_{1,1} &amp; V_{1,2} \cr 
                         V_{2,1} &amp; V_{2,2} \end{bmatrix}, \quad
V^{-1} = \begin{bmatrix} V^{1,1} &amp; V^{1,2} \cr 
                         V^{2,1} &amp; V^{2,2} \end{bmatrix}
\]</div>
<p>Notice that it follows from</p>
<div class="math notranslate nohighlight">
\[
 \begin{bmatrix} V^{1,1} &amp; V^{1,2} \cr 
                         V^{2,1} &amp; V^{2,2} \end{bmatrix} \begin{bmatrix} V_{1,1} &amp; V_{1,2} \cr 
                         V_{2,1} &amp; V_{2,2} \end{bmatrix} = \begin{bmatrix} 1  &amp; 0 \cr 0 &amp; 1 \end{bmatrix}
\]</div>
<p>that</p>
<div class="math notranslate nohighlight">
\[
V^{2,1} V_{1,1} + V^{2,2} V_{2,1} = 0
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
V^{1,1}V_{1,2} + V^{1,2} V_{2,2} = 0.
\]</div>
<p>These equations will be very useful soon.</p>
<p>Notice that</p>
<div class="math notranslate nohighlight">
\[
\begin{bmatrix} x_{1,t+1}^* \cr x_{2,t+1}^* \end{bmatrix} = \begin{bmatrix} \lambda_1  &amp; 0 \cr 0 &amp; \lambda_2 \end{bmatrix}
\begin{bmatrix} x_{1,t}^* \cr x_{2,t}^* \end{bmatrix}
\]</div>
<p>To deactivate <span class="math notranslate nohighlight">\(\lambda_1\)</span> we want to set</p>
<div class="math notranslate nohighlight">
\[
x_{1,0}^* = 0.
\]</div>
<p>This can be achieved by setting</p>
<div class="math notranslate nohighlight" id="equation-eq-deactivate1">
<span class="eqno">(17.19)<a class="headerlink" href="#equation-eq-deactivate1" title="Permalink to this equation">#</a></span>\[
x_{2,0} =  -( V^{1,2})^{-1} V^{1,1} x_{1,0} = V_{2,2} V_{1,2}^{-1} x_{1,0}.
\]</div>
<p>To deactivate <span class="math notranslate nohighlight">\(\lambda_2\)</span>, we want to  set</p>
<div class="math notranslate nohighlight">
\[
x_{2,0}^* = 0
\]</div>
<p>This can be achieved by setting</p>
<div class="math notranslate nohighlight" id="equation-eq-deactivate2">
<span class="eqno">(17.20)<a class="headerlink" href="#equation-eq-deactivate2" title="Permalink to this equation">#</a></span>\[
x_{2,0} = -(V^{2,2})^{-1} V^{2,1} x_{1,0} = V_{2,1} V_{1,1}^{-1} x_{1,0}.
\]</div>
<p>Let’s verify <a class="reference internal" href="#equation-eq-deactivate1">(17.19)</a> and <a class="reference internal" href="#equation-eq-deactivate2">(17.20)</a> below</p>
<p>To deactivate <span class="math notranslate nohighlight">\(\lambda_1\)</span> we use <a class="reference internal" href="#equation-eq-deactivate1">(17.19)</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xd_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">x_0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                 <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_0</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="c1"># Compute x_{1,0}^*</span>
<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">V_inv</span> <span class="o">@</span> <span class="n">xd_1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We find <span class="math notranslate nohighlight">\(x_{1,0}^* = 0\)</span>.</p>
<p>Now we deactivate <span class="math notranslate nohighlight">\(\lambda_2\)</span> using <a class="reference internal" href="#equation-eq-deactivate2">(17.20)</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xd_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">x_0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                 <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_0</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                 <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="c1"># Compute x_{2,0}^*</span>
<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">V_inv</span> <span class="o">@</span> <span class="n">xd_2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We find <span class="math notranslate nohighlight">\(x_{2,0}^* = 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate with muted λ1 λ2.</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">xs_λ1</span> <span class="o">=</span> <span class="n">iterate_M</span><span class="p">(</span><span class="n">xd_1</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xs_λ2</span> <span class="o">=</span> <span class="n">iterate_M</span><span class="p">(</span><span class="n">xd_2</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Compute ratios y_t / y_{t-1}</span>
<span class="n">ratios_λ1</span> <span class="o">=</span> <span class="n">xs_λ1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">xs_λ1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ratios_λ2</span> <span class="o">=</span> <span class="n">xs_λ2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">xs_λ2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<p>The following graph shows the ratios <span class="math notranslate nohighlight">\(y_t / y_{t-1}\)</span> for the two cases.</p>
<p>We find that the ratios converge to <span class="math notranslate nohighlight">\(\lambda_2\)</span> in the first case and <span class="math notranslate nohighlight">\(\lambda_1\)</span> in the second case.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the ratios for y_t / y_{t-1}</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># First subplot</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ratios_λ1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> 
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{y_t}</span><span class="s1">{y_{t-1}}$&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Λ</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> 
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\lambda_2$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{y_t}</span><span class="s1">{y_{t-1}}$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{y_t}</span><span class="s1">{y_{t-1}}$ after Muting $\lambda_1$&#39;</span><span class="p">,</span> 
                 <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Second subplot</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ratios_λ2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{y_t}</span><span class="s1">{y_{t-1}}$&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Λ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> 
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\lambda_1$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{y_t}</span><span class="s1">{y_{t-1}}$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{y_t}</span><span class="s1">{y_{t-1}}$ after Muting $\lambda_2$&#39;</span><span class="p">,</span> 
                 <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="concluding-remarks">
<h2><span class="section-number">17.8. </span>Concluding remarks<a class="headerlink" href="#concluding-remarks" title="Permalink to this heading">#</a></h2>
<p>This lecture sets the stage  for many other applications of the <em>invariant subspace</em> methods.</p>
<p>All of these exploit very similar equations based on eigen decompositions.</p>
<p>We shall encounter equations very similar to <a class="reference internal" href="#equation-eq-deactivate1">(17.19)</a> and <a class="reference internal" href="#equation-eq-deactivate2">(17.20)</a>
in <a class="reference internal" href="money_inflation.html"><span class="doc">Money Financed Government Deficits and Price Levels</span></a> and in many other places in dynamic economic theory.</p>
</section>
<section id="exercise">
<h2><span class="section-number">17.9. </span>Exercise<a class="headerlink" href="#exercise" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="greek_square_ex_a">

<p class="admonition-title"><span class="caption-number">Exercise 17.1 </span></p>
<section id="exercise-content">
<p>Please use matrix algebra to formulate the method described by Bertrand Russell at the beginning of this lecture.</p>
<ol class="arabic simple">
<li><p>Define a state vector <span class="math notranslate nohighlight">\(x_t = \begin{bmatrix} a_t \cr b_t \end{bmatrix}\)</span>.</p></li>
<li><p>Formulate a first-order vector difference equation for <span class="math notranslate nohighlight">\(x_t\)</span> of the form <span class="math notranslate nohighlight">\(x_{t+1} = A x_t\)</span> and
compute the matrix <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p>Use the system <span class="math notranslate nohighlight">\(x_{t+1} = A x_t\)</span> to replicate the sequence of <span class="math notranslate nohighlight">\(a_t\)</span>’s and <span class="math notranslate nohighlight">\(b_t\)</span>’s described by Bertrand Russell.</p></li>
<li><p>Compute the eigenvectors and eigenvalues of <span class="math notranslate nohighlight">\(A\)</span> and compare them to corresponding objects computed in the text of this lecture.</p></li>
</ol>
</section>
</div>
<div class="solution dropdown admonition" id="greek_square-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#greek_square_ex_a"> Exercise 17.1</a></p>
<section id="solution-content">
<p>Here is one soluition.</p>
<p>According to the quote, we can formulate</p>
<div class="math notranslate nohighlight" id="equation-eq-gs-ex1system">
<span class="eqno">(17.21)<a class="headerlink" href="#equation-eq-gs-ex1system" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
a_{t+1} &amp;= a_t + b_t \\
b_{t+1} &amp;= 2a_t + b_t
\end{aligned}
\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(x_0 = \begin{bmatrix}  a_0 \cr b_0 \end{bmatrix} = \begin{bmatrix}  1 \cr 1 \end{bmatrix}\)</span></p>
<p>By <a class="reference internal" href="#equation-eq-gs-ex1system">(17.21)</a>, we can write matrix <span class="math notranslate nohighlight">\(A\)</span> as</p>
<div class="math notranslate nohighlight">
\[
A = \begin{bmatrix} 1 &amp; 1 \cr 
                2 &amp; 1 \end{bmatrix}
\]</div>
<p>Then <span class="math notranslate nohighlight">\(x_{t+1} = A x_t\)</span> for <span class="math notranslate nohighlight">\(t \in \{0, \dots, 5\}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the matrix A</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="c1"># Initial vector x_0</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Number of iterations</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># Generate the sequence</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_0</span><span class="p">])</span>
<span class="n">x_t</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">x_t</span> <span class="o">=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">x_t</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="n">x_t</span><span class="p">])</span>

<span class="c1"># Print the sequence</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">a_t</span><span class="p">,</span> <span class="n">b_t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iter </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: a_t = </span><span class="si">{</span><span class="n">a_t</span><span class="si">}</span><span class="s2">, b_t = </span><span class="si">{</span><span class="n">b_t</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Compute eigenvalues and eigenvectors of A</span>
<span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Eigenvalues:</span><span class="se">\n</span><span class="si">{</span><span class="n">eigenvalues</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Eigenvectors:</span><span class="se">\n</span><span class="si">{</span><span class="n">eigenvectors</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
</section>
</section>

        <script type="text/x-thebe-config">
        {
            "rootPath": "./",
            "requestKernel": true,
            "useJupyterLite": true,
            "useBinder": false,
            "kernelOptions": {
                "path": "/"
            },
            "codeMirrorConfig": {
                "theme": "default",
                "mode": "python"
            },
            "mountRestartButton": false,
            "mountRestartallButton": false
        }
        </script>
        <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="eigen_I.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">16. </span>Eigenvalues and Eigenvectors</p>
      </div>
    </a>
    <a class="right-next"
       href="prob_dist.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">18. </span>Distributions and Probabilities</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">17.1. Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perfect-squares-and-irrational-numbers">17.2. Perfect squares and irrational numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order-linear-difference-equations">17.3. Second-order linear difference equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm-of-the-ancient-greeks">17.4. Algorithm of the Ancient Greeks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">17.5. Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorizing-the-difference-equation">17.6. Vectorizing the difference equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invariant-subspace-approach">17.7. Invariant subspace approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concluding-remarks">17.8. Concluding remarks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">17.9. Exercise</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By QuantEcon team
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on February 1, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
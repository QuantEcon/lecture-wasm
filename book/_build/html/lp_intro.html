

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>36. Linear Programming &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/code.css" />
    <link rel="stylesheet" type="text/css" href="_static/image_dark_mode.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/fix_admonition_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/fix_dropdown_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/fix_code_header_style.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KZLV7PM9LL"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KZLV7PM9LL');
            </script>
    <script defer="defer" src="_static/refresh.js"></script>
    <script>const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script defer="defer" src="_static/sphinx-thebe-lite.js"></script>
    <script>window.MathJax = {"chtml": {"mtextInheritFont": true}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lp_intro';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://quantecon.org/lp_intro.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="37. Shortest Paths" href="short_path.html" />
    <link rel="prev" title="35. Univariate Time Series with Matrix Algebra" href="time_series_with_matrices.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="February 1, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/qe-logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/qe-logo.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">QuantEcon Intro Lectures</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about.html">1. About These Lectures</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Economic Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="long_run_growth.html">2. Long-Run Growth</a></li>
<li class="toctree-l1"><a class="reference internal" href="business_cycle.html">3. Business Cycles</a></li>
<li class="toctree-l1"><a class="reference internal" href="inflation_history.html">4. Price Level Histories</a></li>
<li class="toctree-l1"><a class="reference internal" href="french_rev.html">5. Inflation During French Revolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="inequality.html">6. Income and Wealth Inequality</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Foundations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro_supply_demand.html">7. Introduction to Supply and Demand</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_equations.html">8. Linear Equations and Matrix Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex_and_trig.html">9. Complex Numbers and Trigonometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="geom_series.html">10. Geometric Series for Elementary Economics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Dynamics: Finite Horizons</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pv.html">11. Present Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="cons_smooth.html">12. Consumption Smoothing</a></li>
<li class="toctree-l1"><a class="reference internal" href="equalizing_difference.html">13. Equalizing Difference Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="cagan_ree.html">14. A Monetarist Theory of Price Levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="cagan_adaptive.html">15. Monetarist Theory of Price Levels with Adaptive Expectations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Dynamics: Infinite Horizons</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="eigen_I.html">16. Eigenvalues and Eigenvectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="greek_square.html">17. Computing Square Roots</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Probability and Distributions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="prob_dist.html">18. Distributions and Probabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="lln_clt.html">19. LLN and CLT</a></li>
<li class="toctree-l1"><a class="reference internal" href="monte_carlo.html">20. Monte Carlo and Option Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="heavy_tails.html">21. Heavy-Tailed Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="schelling.html">22. Racial Segregation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Nonlinear Dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scalar_dynam.html">23. Dynamics in One Dimension</a></li>
<li class="toctree-l1"><a class="reference internal" href="solow.html">24. The Solow-Swan Growth Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="cobweb.html">25. The Cobweb Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="olg.html">26. The Overlapping Generations Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="commod_price.html">27. Commodity Prices</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Monetary-Fiscal Policy Interactions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="money_inflation.html">28. Money Financed Government Deficits and Price Levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="unpleasant.html">29. Some Unpleasant Monetarist Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="money_inflation_nonlinear.html">30. Inflation Rate Laffer Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="laffer_adaptive.html">31. Laffer Curves  with Adaptive Expectations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Stochastic Dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ar1_processes.html">32. AR(1) Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="markov_chains_I.html">33. Markov Chains: Basic Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="markov_chains_II.html">34. Markov Chains: Irreducibility and Ergodicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_series_with_matrices.html">35. Univariate Time Series with Matrix Algebra</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Optimization</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">36. Linear Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="short_path.html">37. Shortest Paths</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modeling in Higher Dimensions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="eigen_II.html">38. The Perron-Frobenius Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_output.html">39. Input-Output Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="lake_model.html">40. A Lake Model of Employment</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">41. Networks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Markets and Competitive Equilibrium</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="supply_demand_multiple_goods.html">42. Supply and Demand with Many Goods</a></li>
<li class="toctree-l1"><a class="reference internal" href="supply_demand_heterogeneity.html">43. Market Equilibrium with Heterogeneity</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Estimation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="simple_linear_regression.html">44. Simple Linear Regression Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="mle.html">45. Maximum Likelihood Estimation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">46. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">47. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">48. Execution Statistics</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/lp_intro.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="_sources/lp_intro.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Linear Programming</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">36.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-production-problem">36.2. Example 1: production problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computation-using-or-tools">36.2.1. Computation: using OR-Tools</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-investment-problem">36.3. Example 2: investment problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">36.3.1. Computation: using OR-Tools</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-form">36.4. Standard form</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-transformations">36.4.1. Useful transformations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">36.4.2. Example 1: production problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computation-using-scipy">36.4.3. Computation: using SciPy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">36.4.4. Example 2: investment problem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">36.5. Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="linear-programming">
<span id="lp-intro"></span><h1><span class="section-number">36. </span>Linear Programming<a class="headerlink" href="#linear-programming" title="Permalink to this heading">#</a></h1>
<p>In this lecture, we will need the following library. Install <a class="reference external" href="https://developers.google.com/optimization">ortools</a> using <code class="docutils literal notranslate"><span class="pre">%pip</span></code>.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">ortools</span>
</pre></div>
</div>
</div>
</div>
<section id="overview">
<h2><span class="section-number">36.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p><strong>Linear programming</strong> problems either maximize or minimize
a linear objective function subject to a set of  linear equality and/or inequality constraints.</p>
<p>Linear programs come in pairs:</p>
<ul class="simple">
<li><p>an original  <strong>primal</strong> problem, and</p></li>
<li><p>an associated <strong>dual</strong> problem.</p></li>
</ul>
<p>If a primal problem involves <em>maximization</em>, the dual problem involves <em>minimization</em>.</p>
<p>If a primal problem involves  <em>minimization</em>*, the dual problem involves *<em>maximization</em>.</p>
<p>We provide a standard form of a linear program and methods to transform other forms of linear programming problems  into a standard form.</p>
<p>We tell how to solve a linear programming problem using <a class="reference external" href="https://scipy.org/">SciPy</a> and <a class="reference external" href="https://developers.google.com/optimization">Google OR-Tools</a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>In another lecture, we will employ the linear programming method to solve the
<span class="xref std std-doc">optimal transport problem</span>.</p>
</div>
<p>Let’s start with some standard imports.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ortools.linear_solver</span><span class="w"> </span><span class="kn">import</span> <span class="n">pywraplp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s start with some examples of linear programming problem.</p>
</section>
<section id="example-1-production-problem">
<h2><span class="section-number">36.2. </span>Example 1: production problem<a class="headerlink" href="#example-1-production-problem" title="Permalink to this heading">#</a></h2>
<p>This example was created by <span id="id1">[]</span></p>
<p>Suppose that a factory can produce two goods called Product <span class="math notranslate nohighlight">\(1\)</span> and Product <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p>To produce each product requires both material and labor.</p>
<p>Selling each product generates revenue.</p>
<p>Required per unit material and labor  inputs and  revenues  are shown in table below:</p>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p></p></th>
<th class="text-center head"><p>Product 1</p></th>
<th class="text-center head"><p>Product 2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Material</p></td>
<td class="text-center"><p>2</p></td>
<td class="text-center"><p>5</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Labor</p></td>
<td class="text-center"><p>4</p></td>
<td class="text-center"><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Revenue</p></td>
<td class="text-center"><p>3</p></td>
<td class="text-center"><p>4</p></td>
</tr>
</tbody>
</table>
</div>
<p>30 units of material and 20 units of labor available.</p>
<p>A firm’s problem is to construct a  production plan that uses its  30 units of materials and 20 units of labor to maximize its revenue.</p>
<p>Let <span class="math notranslate nohighlight">\(x_i\)</span> denote the quantity of Product <span class="math notranslate nohighlight">\(i\)</span> that the firm produces and <span class="math notranslate nohighlight">\(z\)</span> denote the total revenue.</p>
<p>This problem can be formulated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\max_{x_1,x_2} \ &amp; z = 3 x_1 + 4 x_2 \\
\mbox{subject to } \ &amp; 2 x_1 + 5 x_2 \le 30 \\
&amp; 4 x_1 + 2 x_2 \le 20 \\
&amp; x_1, x_2 \ge 0 \\
\end{aligned}
\end{split}\]</div>
<p>The following graph illustrates the firm’s constraints and iso-revenue lines.</p>
<p>Iso-revenue lines show all the combinations of materials and labor that produce the same revenue.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1"># Draw constraint lines</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">6</span><span class="o">-</span><span class="mf">0.4</span><span class="o">*</span><span class="n">x1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$2x_1 + 5x_2=30$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">10</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$4x_1 + 2x_2=20$&quot;</span><span class="p">)</span>


<span class="c1"># Draw the feasible region</span>
<span class="n">feasible_set</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">feasible_set</span><span class="p">)</span>

<span class="c1"># Draw the objective function</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mf">3.875</span><span class="o">-</span><span class="mf">0.75</span><span class="o">*</span><span class="n">x1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;iso-revenue lines&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mf">5.375</span><span class="o">-</span><span class="mf">0.75</span><span class="o">*</span><span class="n">x1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mf">6.875</span><span class="o">-</span><span class="mf">0.75</span><span class="o">*</span><span class="n">x1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

<span class="c1"># Draw the optimal solution</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;optimal solution&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The blue region is the feasible set within which all constraints are satisfied.</p>
<p>Parallel black lines are iso-revenue lines.</p>
<p>The firm’s objective is to find the  parallel black lines to the upper boundary of the feasible set.</p>
<p>The intersection of the feasible set and the highest black line delineates the optimal set.</p>
<p>In this example, the optimal set is the point <span class="math notranslate nohighlight">\((2.5, 5)\)</span>.</p>
<section id="computation-using-or-tools">
<h3><span class="section-number">36.2.1. </span>Computation: using OR-Tools<a class="headerlink" href="#computation-using-or-tools" title="Permalink to this heading">#</a></h3>
<p>Let’s try to solve the same problem using the package <code class="docutils literal notranslate"><span class="pre">ortools.linear_solver</span></code>.</p>
<p>The following cell instantiates a solver and creates two variables specifying the range of values that they can have.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate a GLOP(Google Linear Optimization Package) solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s create two variables <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> such that they can only have nonnegative values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the two variables and let them take on any non-negative value.</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x1&#39;</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Add the constraints to the problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraint 1: 2x_1 + 5x_2 &lt;= 30.0</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">&lt;=</span> <span class="mf">30.0</span><span class="p">)</span>

<span class="c1"># Constraint 2: 4x_1 + 2x_2 &lt;= 20.0</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">&lt;=</span> <span class="mf">20.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s specify the objective function. We use <code class="docutils literal notranslate"><span class="pre">solver.Maximize</span></code> method in the case when we want to maximize the objective function and in the case of minimization we can use <code class="docutils literal notranslate"><span class="pre">solver.Minimize</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Objective function: 3x_1 + 4x_2</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once we solve the problem, we can check whether the solver was successful in solving the problem using its status. If it’s successful, then the status will be equal to <code class="docutils literal notranslate"><span class="pre">pywraplp.Solver.OPTIMAL</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the system.</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>

<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Objective value =&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(x1, x2): (</span><span class="si">{</span><span class="n">x1</span><span class="o">.</span><span class="n">solution_value</span><span class="p">()</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x2</span><span class="o">.</span><span class="n">solution_value</span><span class="p">()</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The problem does not have an optimal solution.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="example-2-investment-problem">
<h2><span class="section-number">36.3. </span>Example 2: investment problem<a class="headerlink" href="#example-2-investment-problem" title="Permalink to this heading">#</a></h2>
<p>We now consider a problem posed and solved by  <span id="id2">[]</span>.</p>
<p>A mutual fund has <span class="math notranslate nohighlight">\( \$ 100,000\)</span> to be invested over a three-year horizon.</p>
<p>Three investment options are available:</p>
<ol class="arabic simple">
<li><p>Annuity:  the fund can  pay a same amount of new capital at the beginning of each of three years and receive a payoff of 130% of total capital invested  at the end of the third year. Once the mutual fund decides to invest in this annuity, it has to keep investing in all subsequent  years in the three year horizon.</p></li>
<li><p>Bank account: the fund can deposit any amount  into a bank at the beginning of each year and receive its capital plus 6% interest at the end of that year. In addition, the mutual fund is permitted to borrow no more than $20,000 at the beginning of each year and is asked to pay back the amount borrowed plus 6% interest at the end of the year. The mutual fund can choose whether to deposit or borrow at the beginning of each year.</p></li>
<li><p>Corporate bond: At the beginning of the second year, a  corporate bond becomes available.
The fund can buy an amount
that is no more than <span class="math notranslate nohighlight">\( \$ \)</span>50,000 of this bond at the beginning of the second year and  at the end of the third year receive a payout of 130% of the amount invested in the bond.</p></li>
</ol>
<p>The mutual fund’s objective is to maximize total payout that it owns at the end of the third year.</p>
<p>We can formulate this  as a linear programming problem.</p>
<p>Let  <span class="math notranslate nohighlight">\(x_1\)</span> be the amount of put in the annuity, <span class="math notranslate nohighlight">\(x_2, x_3, x_4\)</span> be  bank deposit balances at the beginning of the three years,  and <span class="math notranslate nohighlight">\(x_5\)</span> be the amount invested  in the corporate bond.</p>
<p>When <span class="math notranslate nohighlight">\(x_2, x_3, x_4\)</span> are negative, it means that  the mutual fund has borrowed from  bank.</p>
<p>The table below shows the mutual fund’s decision variables together with the timing protocol described above:</p>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p></p></th>
<th class="text-center head"><p>Year 1</p></th>
<th class="text-center head"><p>Year 2</p></th>
<th class="text-center head"><p>Year 3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Annuity</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Bank account</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_2\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_3\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_4\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Corporate bond</p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_5\)</span></p></td>
<td class="text-center"><p>0</p></td>
</tr>
</tbody>
</table>
</div>
<p>The  mutual fund’s decision making proceeds according to the following timing protocol:</p>
<ol class="arabic">
<li><p>At the beginning of the first year, the mutual fund decides how much to invest in the annuity and
how much to deposit in the bank. This decision is subject to the constraint:</p>
<div class="math notranslate nohighlight">
\[
   x_1 + x_2 = 100,000
   \]</div>
</li>
<li><p>At the beginning of the second year, the mutual fund has a bank balance  of <span class="math notranslate nohighlight">\(1.06 x_2\)</span>.
It must keep <span class="math notranslate nohighlight">\(x_1\)</span> in the annuity. It can choose to put <span class="math notranslate nohighlight">\(x_5\)</span> into the corporate bond,
and put <span class="math notranslate nohighlight">\(x_3\)</span> in the bank. These decisions are restricted by</p>
<div class="math notranslate nohighlight">
\[
   x_1 + x_5 = 1.06 x_2 - x_3
   \]</div>
</li>
<li><p>At the beginning of the third year, the mutual fund has a bank account balance equal
to <span class="math notranslate nohighlight">\(1.06 x_3\)</span>. It must again invest  <span class="math notranslate nohighlight">\(x_1\)</span> in the annuity,
leaving it with  a bank account balance equal to <span class="math notranslate nohighlight">\(x_4\)</span>. This situation is summarized by the restriction:</p>
<div class="math notranslate nohighlight">
\[
   x_1 = 1.06 x_3 - x_4
   \]</div>
</li>
</ol>
<p>The mutual fund’s objective function, i.e., its wealth at the end of the third year is:</p>
<div class="math notranslate nohighlight">
\[
1.30 \cdot 3x_1 + 1.06 x_4 + 1.30 x_5
\]</div>
<p>Thus, the mutual fund confronts the linear program:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\max_{x} \ &amp; 1.30 \cdot 3x_1 + 1.06 x_4 + 1.30 x_5 \\
\mbox{subject to } \ &amp; x_1 + x_2 = 100,000\\
 &amp; x_1 - 1.06 x_2 + x_3 + x_5 = 0\\
 &amp; x_1 - 1.06 x_3 + x_4 = 0\\
 &amp; x_2 \ge -20,000\\
 &amp; x_3 \ge -20,000\\
 &amp; x_4 \ge -20,000\\
 &amp; x_5 \le 50,000\\
 &amp; x_j \ge 0, \quad j = 1,5\\
 &amp; x_j \ \text{unrestricted}, \quad j = 2,3,4\\
\end{aligned}
\end{split}\]</div>
<section id="id3">
<h3><span class="section-number">36.3.1. </span>Computation: using OR-Tools<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>Let’s try to solve the above problem using the package <code class="docutils literal notranslate"><span class="pre">ortools.linear_solver</span></code>.</p>
<p>The following cell instantiates a solver and creates two variables specifying the range of values that they can have.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate a GLOP(Google Linear Optimization Package) solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s create five variables <span class="math notranslate nohighlight">\(x_1, x_2, x_3, x_4,\)</span> and <span class="math notranslate nohighlight">\(x_5\)</span> such that they can only have the values defined in the above constraints.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the variables using the ranges available from constraints</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x1&#39;</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="mi">20_000</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x2&#39;</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="mi">20_000</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x3&#39;</span><span class="p">)</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="mi">20_000</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x4&#39;</span><span class="p">)</span>
<span class="n">x5</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">,</span> <span class="s1">&#39;x5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Add the constraints to the problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraint 1: x_1 + x_2 = 100,000</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">==</span> <span class="mf">100_000.0</span><span class="p">)</span>

<span class="c1"># Constraint 2: x_1 - 1.06 * x_2 + x_3 + x_5 = 0</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="mf">1.06</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x5</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Constraint 3: x_1 - 1.06 * x_3 + x_4 = 0</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="mf">1.06</span> <span class="o">*</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s specify the objective function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Objective function: 1.30 * 3 * x_1 + 1.06 * x_4 + 1.30 * x_5</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="mf">1.30</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mf">1.06</span> <span class="o">*</span> <span class="n">x4</span> <span class="o">+</span> <span class="mf">1.30</span> <span class="o">*</span> <span class="n">x5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s solve the problem and check the status using <code class="docutils literal notranslate"><span class="pre">pywraplp.Solver.OPTIMAL</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the system.</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>

<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Objective value =&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">())</span>
    <span class="n">x1_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x2_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x3_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x4_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x5_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(x1, x2, x3, x4, x5): (</span><span class="si">{</span><span class="n">x1_sol</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x2_sol</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x3_sol</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x4_sol</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x5_sol</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The problem does not have an optimal solution.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>OR-Tools tells us that  the best investment strategy is:</p>
<ol class="arabic simple">
<li><p>At the beginning of the first year, the mutual fund should buy <span class="math notranslate nohighlight">\( \$24,927.755\)</span> of the annuity. Its bank account balance should be <span class="math notranslate nohighlight">\( \$75,072.245\)</span>.</p></li>
<li><p>At the beginning of the second year, the mutual fund should buy <span class="math notranslate nohighlight">\( \$24,927.755\)</span> of the corporate bond and keep invest in the annuity. Its bank balance should be <span class="math notranslate nohighlight">\( \$24,927.755\)</span>.</p></li>
<li><p>At the beginning of the third year, the bank balance should be <span class="math notranslate nohighlight">\( \$75,072.245 \)</span>.</p></li>
<li><p>At the end of the third year, the mutual fund will get payouts from the annuity and corporate bond and repay its loan from the bank. At the end  it will own <span class="math notranslate nohighlight">\( \$141,018.24 \)</span>, so that it’s total net  rate of return over the three periods is <span class="math notranslate nohighlight">\( 41.02\%\)</span>.</p></li>
</ol>
</section>
</section>
<section id="standard-form">
<h2><span class="section-number">36.4. </span>Standard form<a class="headerlink" href="#standard-form" title="Permalink to this heading">#</a></h2>
<p>For purposes of</p>
<ul class="simple">
<li><p>unifying linear programs that are initially stated in superficially different forms, and</p></li>
<li><p>having a form that is convenient to put into black-box software packages,</p></li>
</ul>
<p>it is useful to devote some effort to describe a <strong>standard form</strong>.</p>
<p>Our standard form  is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\min_{x} \ &amp; c_1 x_1 + c_2 x_2 + \dots + c_n x_n  \\
\mbox{subject to } \ &amp; a_{11} x_1 + a_{12} x_2 + \dots + a_{1n} x_n = b_1 \\
 &amp; a_{21} x_1 + a_{22} x_2 + \dots + a_{2n} x_n = b_2 \\
 &amp; \quad \vdots \\
 &amp; a_{m1} x_1 + a_{m2} x_2 + \dots + a_{mn} x_n = b_m \\
 &amp; x_1, x_2, \dots, x_n \ge 0 \\
\end{aligned}
\end{split}\]</div>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \begin{bmatrix}
a_{11} &amp; a_{12} &amp; \dots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \dots &amp; a_{2n} \\
  &amp;   &amp; \vdots &amp;   \\
a_{m1} &amp; a_{m2} &amp; \dots &amp; a_{mn} \\
\end{bmatrix}, \quad
b = \begin{bmatrix} b_1 \\ b_2 \\ \vdots \\ b_m \\ \end{bmatrix}, \quad
c = \begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_n \\ \end{bmatrix}, \quad
x = \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \\ \end{bmatrix}. \quad
\end{split}\]</div>
<p>The standard form linear programming problem can be expressed concisely as:</p>
<div class="math notranslate nohighlight" id="equation-lpproblem">
<span class="eqno">(36.1)<a class="headerlink" href="#equation-lpproblem" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\min_{x} \ &amp; c'x \\
\mbox{subject to } \ &amp; Ax = b\\
 &amp; x \geq 0\\
\end{aligned}
\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(Ax = b\)</span> means that  the <span class="math notranslate nohighlight">\(i\)</span>-th entry of <span class="math notranslate nohighlight">\(Ax\)</span>  equals the <span class="math notranslate nohighlight">\(i\)</span>-th entry of <span class="math notranslate nohighlight">\(b\)</span> for every <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Similarly, <span class="math notranslate nohighlight">\(x \geq 0\)</span> means that  <span class="math notranslate nohighlight">\(x_j\)</span> is greater than equal to <span class="math notranslate nohighlight">\(0\)</span> for every <span class="math notranslate nohighlight">\(j\)</span>.</p>
<section id="useful-transformations">
<h3><span class="section-number">36.4.1. </span>Useful transformations<a class="headerlink" href="#useful-transformations" title="Permalink to this heading">#</a></h3>
<p>It is useful to know how to transform a problem that initially is not stated in the standard form into one that is.</p>
<p>By deploying the following steps, any linear programming problem can be transformed into an  equivalent  standard form linear programming problem.</p>
<ol class="arabic simple">
<li><p>Objective function: If a problem is originally a constrained <em>maximization</em> problem, we can construct a new objective function that  is the additive inverse of the original objective function. The transformed problem is then a <em>minimization</em> problem.</p></li>
<li><p>Decision variables: Given a variable <span class="math notranslate nohighlight">\(x_j\)</span> satisfying <span class="math notranslate nohighlight">\(x_j \le 0\)</span>, we can introduce a new variable <span class="math notranslate nohighlight">\(x_j' = - x_j\)</span> and substitute it into original problem. Given a free variable <span class="math notranslate nohighlight">\(x_i\)</span> with no restriction on its sign, we can introduce two new variables <span class="math notranslate nohighlight">\(x_j^+\)</span> and <span class="math notranslate nohighlight">\(x_j^-\)</span> satisfying <span class="math notranslate nohighlight">\(x_j^+, x_j^- \ge 0\)</span> and replace <span class="math notranslate nohighlight">\(x_j\)</span> by <span class="math notranslate nohighlight">\(x_j^+ - x_j^-\)</span>.</p></li>
<li><p>Inequality constraints: Given an inequality constraint <span class="math notranslate nohighlight">\(\sum_{j=1}^n a_{ij}x_j \le 0\)</span>, we can introduce a new variable <span class="math notranslate nohighlight">\(s_i\)</span>, called a <strong>slack variable</strong> that satisfies <span class="math notranslate nohighlight">\(s_i \ge 0\)</span> and replace the original constraint by <span class="math notranslate nohighlight">\(\sum_{j=1}^n a_{ij}x_j + s_i = 0\)</span>.</p></li>
</ol>
<p>Let’s apply the above steps to the two examples described above.</p>
</section>
<section id="id4">
<h3><span class="section-number">36.4.2. </span>Example 1: production problem<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>The original problem is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\max_{x_1,x_2} \ &amp; 3 x_1 + 4 x_2 \\
\mbox{subject to } \ &amp; 2 x_1 + 5 x_2 \le 30 \\
&amp; 4 x_1 + 2 x_2 \le 20 \\
&amp; x_1, x_2 \ge 0 \\
\end{aligned}
\end{split}\]</div>
<p>This problem is equivalent to the following problem with a standard form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\min_{x_1,x_2} \ &amp; -(3 x_1 + 4 x_2) \\
\mbox{subject to } \ &amp; 2 x_1 + 5 x_2 + s_1 = 30 \\
&amp; 4 x_1 + 2 x_2 + s_2 = 20 \\
&amp; x_1, x_2, s_1, s_2 \ge 0 \\
\end{aligned}
\end{split}\]</div>
</section>
<section id="computation-using-scipy">
<h3><span class="section-number">36.4.3. </span>Computation: using SciPy<a class="headerlink" href="#computation-using-scipy" title="Permalink to this heading">#</a></h3>
<p>The package <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code> provides a function <code class="docutils literal notranslate"><span class="pre">linprog</span></code> to solve linear programming problems with a form below:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\min_{x} \ &amp; c' x  \\
\mbox{subject to } \ &amp; A_{ub}x \le b_{ub} \\
 &amp; A_{eq}x = b_{eq} \\
 &amp; l \le x \le u \\
\end{aligned}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(A_{eq}, b_{eq}\)</span> denote the equality constraint matrix and vector, and <span class="math notranslate nohighlight">\(A_{ub}, b_{ub}\)</span> denote the inequality constraint matrix and vector.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default <span class="math notranslate nohighlight">\(l = 0\)</span> and <span class="math notranslate nohighlight">\(u = \text{None}\)</span> unless explicitly specified with the argument <code class="docutils literal notranslate"><span class="pre">bounds</span></code>.</p>
</div>
<p>Let’s now try to solve the Problem 1 using SciPy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct parameters</span>
<span class="n">c_ex1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="c1"># Inequality constraints</span>
<span class="n">A_ex1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">b_ex1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Once we solve the problem, we can check whether the solver was successful in solving the problem using the boolean attribute <code class="docutils literal notranslate"><span class="pre">success</span></code>. If it’s successful, then the <code class="docutils literal notranslate"><span class="pre">success</span></code> attribute is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the problem</span>
<span class="c1"># we put a negative sign on the objective as linprog does minimization</span>
<span class="n">res_ex1</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="o">-</span><span class="n">c_ex1</span><span class="p">,</span> <span class="n">A_ub</span><span class="o">=</span><span class="n">A_ex1</span><span class="p">,</span> <span class="n">b_ub</span><span class="o">=</span><span class="n">b_ex1</span><span class="p">)</span>

<span class="k">if</span> <span class="n">res_ex1</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="c1"># We use negative sign to get the optimal value (maximized value)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Optimal Value:&#39;</span><span class="p">,</span> <span class="o">-</span><span class="n">res_ex1</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(x1, x2): </span><span class="si">{</span><span class="n">res_ex1</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">res_ex1</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The problem does not have an optimal solution.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The optimal plan tells the  factory to produce <span class="math notranslate nohighlight">\(2.5\)</span> units of Product 1 and <span class="math notranslate nohighlight">\(5\)</span> units of  Product 2; that  generates a maximizing value of  revenue of <span class="math notranslate nohighlight">\(27.5\)</span>.</p>
<p>We are using the <code class="docutils literal notranslate"><span class="pre">linprog</span></code> function as a <em>black box</em>.</p>
<p>Inside it, Python first  transforms the problem into  standard form.</p>
<p>To do that, for each inequality constraint it generates one slack variable.</p>
<p>Here the vector of slack variables is a two-dimensional NumPy array that  equals <span class="math notranslate nohighlight">\(b_{ub} - A_{ub}x\)</span>.</p>
<p>See the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.linprog.html#scipy.optimize.linprog">official documentation</a> for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This problem is to maximize the objective, so that we need to put a minus sign in front of parameter vector <span class="math notranslate nohighlight">\(c\)</span>.</p>
</div>
</section>
<section id="id5">
<h3><span class="section-number">36.4.4. </span>Example 2: investment problem<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>The original problem is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\max_{x} \ &amp; 1.30 \cdot 3x_1 + 1.06 x_4 + 1.30 x_5 \\
\mbox{subject to } \ &amp; x_1 + x_2 = 100,000\\
 &amp; x_1 - 1.06 x_2 + x_3 + x_5 = 0\\
 &amp; x_1 - 1.06 x_3 + x_4 = 0\\
 &amp; x_2 \ge -20,000\\
 &amp; x_3 \ge -20,000\\
 &amp; x_4 \ge -20,000\\
 &amp; x_5 \le 50,000\\
 &amp; x_j \ge 0, \quad j = 1,5\\
 &amp; x_j \ \text{unrestricted}, \quad j = 2,3,4\\
\end{aligned}
\end{split}\]</div>
<p>This problem is equivalent to the following problem with a standard form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\min_{x} \ &amp; -(1.30 \cdot 3x_1 + 1.06 x_4^+ - 1.06 x_4^- + 1.30 x_5) \\
\mbox{subject to } \ &amp; x_1 + x_2^+ - x_2^- = 100,000\\
 &amp; x_1 - 1.06 (x_2^+ - x_2^-) + x_3^+ - x_3^- + x_5 = 0\\
 &amp; x_1 - 1.06 (x_3^+ - x_3^-) + x_4^+ - x_4^- = 0\\
 &amp; x_2^- - x_2^+ + s_1 = 20,000\\
 &amp; x_3^- - x_3^+ + s_2 = 20,000\\
 &amp; x_4^- - x_4^+ + s_3 = 20,000\\
 &amp; x_5 + s_4 = 50,000\\
 &amp; x_j \ge 0, \quad j = 1,5\\
 &amp; x_j^+, x_j^- \ge 0, \quad j = 2,3,4\\
 &amp; s_j \ge 0, \quad j = 1,2,3,4\\
\end{aligned}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct parameters</span>
<span class="n">rate</span> <span class="o">=</span> <span class="mf">1.06</span>

<span class="c1"># Objective function parameters</span>
<span class="n">c_ex2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.30</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.06</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">])</span>

<span class="c1"># Inequality constraints</span>
<span class="n">A_ex2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">rate</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">rate</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">b_ex2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100_000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># Bounds on decision variables</span>
<span class="n">bounds_ex2</span> <span class="o">=</span> <span class="p">[(</span>  <span class="mi">0</span><span class="p">,</span>    <span class="kc">None</span><span class="p">),</span>
              <span class="p">(</span><span class="o">-</span><span class="mi">20_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
              <span class="p">(</span><span class="o">-</span><span class="mi">20_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
              <span class="p">(</span><span class="o">-</span><span class="mi">20_000</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
              <span class="p">(</span>  <span class="mi">0</span><span class="p">,</span>   <span class="mi">50_000</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s solve the problem and check the status using <code class="docutils literal notranslate"><span class="pre">success</span></code> attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the problem</span>
<span class="n">res_ex2</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="o">-</span><span class="n">c_ex2</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_ex2</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_ex2</span><span class="p">,</span>
                  <span class="n">bounds</span><span class="o">=</span><span class="n">bounds_ex2</span><span class="p">)</span>

<span class="k">if</span> <span class="n">res_ex2</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="c1"># We use negative sign to get the optimal value (maximized value)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Optimal Value:&#39;</span><span class="p">,</span> <span class="o">-</span><span class="n">res_ex2</span><span class="o">.</span><span class="n">fun</span><span class="p">)</span>
    <span class="n">x1_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_ex2</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x2_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_ex2</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x3_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_ex2</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x4_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_ex2</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x5_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_ex2</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(x1, x2, x3, x4, x5): </span><span class="si">{</span><span class="n">x1_sol</span><span class="p">,</span><span class="w"> </span><span class="n">x2_sol</span><span class="p">,</span><span class="w"> </span><span class="n">x3_sol</span><span class="p">,</span><span class="w"> </span><span class="n">x4_sol</span><span class="p">,</span><span class="w"> </span><span class="n">x5_sol</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The problem does not have an optimal solution.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>SciPy tells us that  the best investment strategy is:</p>
<ol class="arabic simple">
<li><p>At the beginning of the first year, the mutual fund should buy <span class="math notranslate nohighlight">\( \$24,927.75\)</span> of the annuity. Its bank account balance should be <span class="math notranslate nohighlight">\( \$75,072.25\)</span>.</p></li>
<li><p>At the beginning of the second year, the mutual fund should buy <span class="math notranslate nohighlight">\( \$50,000 \)</span> of the corporate bond and keep invest in the annuity. Its bank account balance should be <span class="math notranslate nohighlight">\( \$ 4,648.83\)</span>.</p></li>
<li><p>At the beginning of the third year, the mutual fund should borrow <span class="math notranslate nohighlight">\( \$20,000\)</span> from the bank and invest in the annuity.</p></li>
<li><p>At the end of the third year, the mutual fund will get payouts from the annuity and corporate bond and repay its loan from the bank. At the end  it will own <span class="math notranslate nohighlight">\( \$141,018.24 \)</span>, so that it’s total net  rate of return over the three periods is <span class="math notranslate nohighlight">\( 41.02\% \)</span>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You might notice the difference in the values of optimal solution using OR-Tools and SciPy but the optimal value is the same. It is because there can be many optimal solutions for the same problem.</p>
</div>
</section>
</section>
<section id="exercises">
<h2><span class="section-number">36.5. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="lp_intro_ex1">

<p class="admonition-title"><span class="caption-number">Exercise 36.1 </span></p>
<section id="exercise-content">
<p>Implement a new extended solution for the Problem 1 where in the factory owner decides that number of units of Product 1 should not be less than the number of units of Product 2.</p>
</section>
</div>
<div class="solution dropdown admonition" id="lp_intro-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#lp_intro_ex1"> Exercise 36.1</a></p>
<section id="solution-content">
<p>So we can reformulate the problem as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\max_{x_1,x_2} \ &amp; z = 3 x_1 + 4 x_2 \\
\mbox{subject to } \ &amp; 2 x_1 + 5 x_2 \le 30 \\
&amp; 4 x_1 + 2 x_2 \le 20 \\
&amp; x_1 \ge x_2 \\
&amp; x_1, x_2 \ge 0 \\
\end{aligned}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate a GLOP(Google Linear Optimization Package) solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>

<span class="c1"># Create the two variables and let them take on any non-negative value.</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x1&#39;</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraint 1: 2x_1 + 5x_2 &lt;= 30.0</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">&lt;=</span> <span class="mf">30.0</span><span class="p">)</span>

<span class="c1"># Constraint 2: 4x_1 + 2x_2 &lt;= 20.0</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">&lt;=</span> <span class="mf">20.0</span><span class="p">)</span>

<span class="c1"># Constraint 3: x_1 &gt;= x_2</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">x1</span> <span class="o">&gt;=</span> <span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Objective function: 3x_1 + 4x_2</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the system.</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>

<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Objective value =&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">())</span>
    <span class="n">x1_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">x2_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(x1, x2): (</span><span class="si">{</span><span class="n">x1_sol</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">x2_sol</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The problem does not have an optimal solution.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="lp_intro_ex2">

<p class="admonition-title"><span class="caption-number">Exercise 36.2 </span></p>
<section id="exercise-content">
<p>A carpenter manufactures <span class="math notranslate nohighlight">\(2\)</span> products - <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>Product <span class="math notranslate nohighlight">\(A\)</span> generates a profit of <span class="math notranslate nohighlight">\(23\)</span> and product <span class="math notranslate nohighlight">\(B\)</span> generates a profit of <span class="math notranslate nohighlight">\(10\)</span>.</p>
<p>It takes <span class="math notranslate nohighlight">\(2\)</span> hours for the carpenter to produce <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(0.8\)</span> hours to produce <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>Moreover, he can’t spend more than <span class="math notranslate nohighlight">\(25\)</span> hours per week and the total number of units of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> should not be greater than <span class="math notranslate nohighlight">\(20\)</span>.</p>
<p>Find the number of units of <span class="math notranslate nohighlight">\(A\)</span> and product <span class="math notranslate nohighlight">\(B\)</span> that he should manufacture in order to maximise his profit.</p>
</section>
</div>
<div class="solution dropdown admonition" id="lp_intro-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#lp_intro_ex2"> Exercise 36.2</a></p>
<section id="solution-content">
<p>Let us assume the carpenter produces <span class="math notranslate nohighlight">\(x\)</span> units of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(y\)</span> units of <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>So we can formulate the problem as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\max_{x,y} \ &amp; z = 23 x + 10 y \\
\mbox{subject to } \ &amp; x + y \le 20 \\
&amp; 2 x + 0.8 y \le 25 \\
\end{aligned}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate a GLOP(Google Linear Optimization Package) solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s create two variables <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> such that they can only have nonnegative values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the two variables and let them take on any non-negative value.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraint 1: x + y &lt;= 20.0</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mf">20.0</span><span class="p">)</span>

<span class="c1"># Constraint 2: 2x + 0.8y &lt;= 25.0</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mf">25.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Objective function: 23x + 10y</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="mi">23</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the system.</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>

<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum Profit =&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">())</span>
    <span class="n">x_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">y_sol</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">solution_value</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(x, y): (</span><span class="si">{</span><span class="n">x_sol</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">y_sol</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The problem does not have an optimal solution.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
</section>
</section>

        <script type="text/x-thebe-config">
        {
            "rootPath": "./",
            "requestKernel": true,
            "useJupyterLite": true,
            "useBinder": false,
            "kernelOptions": {
                "path": "/"
            },
            "codeMirrorConfig": {
                "theme": "default",
                "mode": "python"
            },
            "mountRestartButton": false,
            "mountRestartallButton": false
        }
        </script>
        <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="time_series_with_matrices.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">35. </span>Univariate Time Series with Matrix Algebra</p>
      </div>
    </a>
    <a class="right-next"
       href="short_path.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">37. </span>Shortest Paths</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">36.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-production-problem">36.2. Example 1: production problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computation-using-or-tools">36.2.1. Computation: using OR-Tools</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-investment-problem">36.3. Example 2: investment problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">36.3.1. Computation: using OR-Tools</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-form">36.4. Standard form</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-transformations">36.4.1. Useful transformations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">36.4.2. Example 1: production problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computation-using-scipy">36.4.3. Computation: using SciPy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">36.4.4. Example 2: investment problem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">36.5. Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By QuantEcon team
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on February 1, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>